{% extends "base.html" %}
{% set panel = "Make a Loan" %}
{% block mainblock %}
<div class="col-xl-8 col-sm-8 p-4">
  <div class="card card-common shadow-lg rounded-4">
    <div class="card-header bg-light">
      <h2 class="text-center text-dark fw-bold">MAKE A LOAN</h2>
    </div>

    <div class="card-body">
      <!-- Success/Error message card - same style as add_book -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="card mb-3 {% if category == 'success' %}border-success{% elif category == 'warning' %}border-warning{% else %}border-danger{% endif %} shadow-sm">
              <div class="card-body text-center {% if category == 'success' %}text-success{% elif category == 'warning' %}text-warning{% else %}text-danger{% endif %} fw-bold">
                {{ message }}
              </div>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form action="{{ url_for('packageController.make_loan', book_id=book.id) }}" method="post">
        
        <!-- Book Title -->
        <div class="mb-3">
          <label class="form-label fw-bold">Book Title:</label>
          <input type="text" class="form-control" value="{{ book.title }}" readonly>
        </div>

        <!-- Current User -->
        <div class="mb-3">
          <label class="form-label fw-bold">User:</label>
          <input type="text" class="form-control" value="{{ current_user.name }}" readonly>
        </div>

        <!-- Available Copies -->
        <div class="mb-3">
          <label class="form-label fw-bold">Available Copies:</label>
          <input type="text" class="form-control" value="{{ book.available }}" readonly>
        </div>

        <!-- Information Message -->
        <div class="alert alert-info">
          <strong>Note:</strong> The borrow date will be automatically set to a random date (10-20 days after today).
        </div>

        <button type="submit" class="btn btn-primary w-100">Confirm Loan</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}